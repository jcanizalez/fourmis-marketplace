---
name: OpenAPI Generation
description: Generates OpenAPI 3.0 specifications from discovered API routes. Activates when asked to create OpenAPI specs, Swagger docs, or when the /openapi command is used.
version: 1.0.0
---

# OpenAPI Generation

This skill activates when generating OpenAPI specifications from code.

## When to Activate

- User asks for an OpenAPI spec or Swagger doc
- The `/openapi` command is invoked
- User asks to document their API in a standard format

## OpenAPI 3.0 Template

Generate specs following this structure:

```yaml
openapi: 3.0.3
info:
  title: <Project Name> API
  description: <Auto-generated description>
  version: 1.0.0

servers:
  - url: http://localhost:<port>
    description: Local development

paths:
  /api/users:
    get:
      summary: List users
      operationId: listUsers
      tags:
        - Users
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
        - name: offset
          in: query
          schema:
            type: integer
            default: 0
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/User'
        '401':
          description: Unauthorized

    post:
      summary: Create a user
      operationId: createUser
      tags:
        - Users
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateUserRequest'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '400':
          description: Validation error
        '409':
          description: User already exists

components:
  schemas:
    User:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        email:
          type: string
          format: email
        createdAt:
          type: string
          format: date-time
```

## Generation Rules

1. **Infer types from code**: Read TypeScript interfaces, Go structs, or Python dataclasses to build schemas
2. **Extract status codes**: Look for explicit `res.status(X)`, `w.WriteHeader(X)`, or `return c.JSON(X, ...)` calls
3. **Detect auth requirements**: If middleware like `requireAuth`, `authenticate`, or JWT validation is applied, mark the endpoint as requiring authorization
4. **Group by resource**: Use tags to group related endpoints (e.g., all `/users/*` under "Users")
5. **Generate operationIds**: Use camelCase from the handler name or method+resource pattern (e.g., `listUsers`, `createUser`, `getUserById`)
6. **Include examples**: When possible, generate realistic example values for request/response bodies

## Schema Extraction

### From TypeScript/JavaScript
```typescript
// Look for interfaces, types, and Zod schemas
interface User { id: string; name: string; email: string; }
type CreateUserRequest = { name: string; email: string; }
const userSchema = z.object({ name: z.string(), email: z.string().email() })
```

### From Go
```go
// Look for struct definitions used in handlers
type User struct {
    ID    string `json:"id"`
    Name  string `json:"name"`
    Email string `json:"email"`
}
```

### From Python
```python
# Look for Pydantic models, dataclasses
class User(BaseModel):
    id: str
    name: str
    email: EmailStr
```

## Output

- Generate the spec as YAML (preferred for readability) or JSON
- Offer to save to `openapi.yaml` or `openapi.json` at the project root
- If a spec already exists, offer to update it with newly discovered endpoints
- Warn about any endpoints that couldn't be fully documented (missing types, unclear params)
